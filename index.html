
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Short Squeeze Dashboard</title>
  <style>
    body {
      margin: 0;
      background-color: #0a0a0a;
      color: #00ffff;
      font-family: monospace;
      padding: 20px;
    }
    h1, h2 {
      color: #00ffff;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: #111;
    }
    th, td {
      border: 1px solid #00ffff;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #222;
    }
    .ticker-caption {
      color: #00ffff;
      font-size: 14px;
      margin: 10px 0;
      text-align: center;
    }
    .chart-section {
      margin-top: 60px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #00ffff;
      color: #000;
      border: none;
      cursor: pointer;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

<div>
  <div class="ticker-caption">üìâ Ticker Tape (15 min delay)</div>
  <div class="tradingview-widget-container__widget" id="tickerContainer"></div>
  <div style="text-align: center; margin-top: 10px;">
    <label for="tickerInput">üìà Add Stock to Ticker Tape:</label>
    <input type="text" id="tickerInput" placeholder="e.g. NASDAQ:AAPL" style="padding: 6px; margin-left: 5px;" />
    <button onclick="addToTicker()" style="padding: 6px 12px; font-size: 14px;">Add</button>
  </div>
    
</div>

<div style="margin-top: 60px;">
  <h2 style="text-align:center;">üìä Live Short Squeeze Radar</h2>
  <div style="text-align:center;">
    <button onclick="loadRadarData()">üîÑ Refresh Radar</button>
  </div>
  <div id="squeeze-radar-table"></div>
</div>

<div class="chart-section">
  <h2 style="text-align:center;">üìà Live Chart</h2>
  <div id="tradingview-widget" style="height:700px;"></div>
</div>

<script type="text/javascript">
  async function loadRadarData() {
    try {
      const response = await fetch("https://raw.githubusercontent.com/marlattmedia/squeeze-radar/main/squeeze-radar.json");
      const data = await response.json();

      const tableHTML = `
        <table>
          <thead>
            <tr>
              <th>Ticker</th>
              <th>Company</th>
              <th>Float</th>
              <th>Short %</th>
              <th>Avg Volume</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${data.map(function(row) {
              return `
              <tr>
                <td>${row.ticker}</td>
                <td>${row.company}</td>
                <td>${row.float}</td>
                <td>${row.shortPercent}</td>
                <td>${row.volume}</td>
                <td>${row.notes}</td>
              </tr>`;
            }).join("")}
          </tbody>
        </table>
      `;
      document.getElementById("squeeze-radar-table").innerHTML = tableHTML;
    } catch (err) {
      document.getElementById("squeeze-radar-table").innerHTML = "<p style='color:red;'>‚ö†Ô∏è Error loading data. Please check the JSON URL.</p>";
    }
  }

  function loadDefaultChart() {
    const container = document.getElementById("tradingview-widget");
    container.innerHTML = "";

    const script = document.createElement("script");
    script.src = "https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js";
    script.async = true;
    script.innerHTML = JSON.stringify({
      "autosize": true,
      "symbol": "NASDAQ:GME",
      "interval": "D",
      "timezone": "Etc/UTC",
      "theme": "dark",
      "style": "1",
      "locale": "en",
      "allow_symbol_change": true,
      "support_host": "https://www.tradingview.com"
    });

    container.appendChild(script);
  }

  window.onload = function () {
    loadRadarData();
    loadDefaultChart();
  };
</script>



<script>
  let tickerSymbols = [];

  function addToTicker() {
    const input = document.getElementById("tickerInput").value.trim().toUpperCase();
    if (!input || tickerSymbols.includes(input)) return;

    tickerSymbols.push(input);
    renderTickerTape();
  }

  function renderTickerTape() {
    const container = document.getElementById("tickerContainer");
    container.innerHTML = "";

    const script = document.createElement("script");
    script.src = "https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js";
    script.async = true;
    script.innerHTML = JSON.stringify({
      "symbols": tickerSymbols.map(s => ({ proName: s, title: s.split(":")[1] || s })),
      "showSymbolLogo": true,
      "isTransparent": false,
      "displayMode": "adaptive",
      "colorTheme": "dark",
      "locale": "en"
    });

    container.appendChild(script);
  }

  window.onload = function () {
    loadRadarData();
    loadDefaultChart();
    renderTickerTape();
  };
</script>
</body>
</html>
