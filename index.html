<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Squeeze Radar + Reddit Sentiment</title>
  <style>
    body {
      background-color: #111;
      color: #f1f1f1;
      font-family: Arial, sans-serif;
      padding: 30px;
    }
    h1, h2, h3 {
      color: #ffcc00;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      margin-bottom: 40px;
    }
    th, td {
      padding: 10px;
      text-align: center;
      border: 1px solid #333;
    }
    th {
      background-color: #222;
    }
    tr:nth-child(even) {
      background-color: #1a1a1a;
    }
    section {
      margin-bottom: 50px;
    }
  </style>
</head>
<body>

<h1>üìà Live Short Squeeze & Reddit Sentiment Dashboard</h1>

<section>
  <h2>üß† Short Squeeze Radar</h2>
  <table id="squeezeTable">
    <thead>
      <tr>
        <th>Ticker</th>
        <th>Company</th>
        <th>Float</th>
        <th>Short %</th>
        <th>Avg Volume</th>
        <th>Notes</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<section>
  <h2>üì£ Reddit Sentiment Radar</h2>
  <div id="redditResults">
    <p style="color:#999;">Loading Reddit sentiment data...</p>
  </div>
</section>

<script>
// Squeeze Radar Loader
fetch("https://marlattmedia.github.io/squeeze-radar/squeeze-radar.json")
  .then(res => res.json())
  .then(data => {
    const tbody = document.querySelector("#squeezeTable tbody");
    tbody.innerHTML = "";

    const filtered = data.filter(stock => {
      const num = parseFloat(stock.avg_volume.replace(/[^0-9.]/g, ""));
      return num < 5000; // under 5M
    });

    if (filtered.length === 0) {
      tbody.innerHTML = "<tr><td colspan='6'>No stocks meet current squeeze criteria.</td></tr>";
    } else {
      filtered.forEach(stock => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${stock.ticker}</td>
          <td>${stock.company}</td>
          <td>${stock.float}</td>
          <td>${stock.short_percent}</td>
          <td>${stock.avg_volume}</td>
          <td>${stock.notes}</td>
        `;
        tbody.appendChild(row);
      });
    }
  })
  .catch(() => {
    document.querySelector("#squeezeTable tbody").innerHTML = "<tr><td colspan='6'>‚ö†Ô∏è Error loading squeeze data</td></tr>";
  });

// Reddit Sentiment Loader
fetch("https://marlattmedia.github.io/squeeze-radar/reddit-sentiment.json")
  .then(res => res.json())
  .then(data => {
    const container = document.getElementById("redditResults");
    if (!data || data.length === 0) {
      container.innerHTML = "<p>No Reddit sentiment data available.</p>";
      return;
    }

    let content = "<table><thead><tr><th>Subreddit</th><th>Ticker</th><th>Mentions</th><th>Rank</th></tr></thead><tbody>";
    data.forEach(item => {
      content += `<tr>
        <td>${item.subreddit}</td>
        <td>${item.ticker}</td>
        <td>${item.mentions}</td>
        <td>${item.rank}</td>
      </tr>`;
    });
    content += "</tbody></table>";
    container.innerHTML = content;
  })
  .catch(() => {
    document.getElementById("redditResults").innerHTML = "<p style='color:#f88;'>‚ö†Ô∏è Failed to load Reddit sentiment data.</p>";
  });
</script>

</body>
</html>